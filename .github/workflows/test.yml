name: Build and Test
on: [ pull_request ]

jobs:
  build_and_test:
    runs-on: ubuntu-latest
    name: Build and Test
    steps:
    - name: Checkout this commit
      uses: actions/checkout@v2
      with:
        fetch-depth: 0

    - name: C++ Style Check (compiled)
      uses: Dal-Papa/actions-uncrustify@v1.2

    - run: sudo apt-get update
    - run: sudo apt-get install software-properties-common
    - run: sudo apt-get update
    - run: sudo apt-get install scons g++-9 libboost-dev libboost-program-options-dev libboost-regex-dev libboost-filesystem-dev libmariadbclient-dev libmariadb3 ccache
    - run: scons -C code -j4 -Q ccache=1 pretty=0 sanitize=1 shared=0 check sneezy


